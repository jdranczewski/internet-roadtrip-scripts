<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Viewer for the Internet Roadtrip</title>
        <style>
        html, body, #main_frame {
            width: 100%;
            height: 100%;
            margin: 0;
            border: none;
            overflow: hidden;
        }
        </style>
    </head>
    <body>
        <iframe id="main_frame"></iframe>
        <script type="text/javascript">
        const socket = new WebSocket(
            "wss://internet-roadtrip-listen-eqzms.ondigitalocean.app",
        );
        let pano;
        let heading;
        const iframe = document.getElementById("main_frame");
        const key = "API_KEY";
        socket.onmessage = async (event) => {
            const msg = JSON.parse(event.data);
            if (pano === msg.pano || heading === msg.heading) return;
            console.log(msg);
            pano = msg.pano;
            heading = msg.heading;
            iframe.src = `https://www.google.com/maps/embed/v1/streetview?key=${key}&pano=${pano}&heading=${heading}&pitch=10&fov=90`
        }
        </script>
    </body>
</html>